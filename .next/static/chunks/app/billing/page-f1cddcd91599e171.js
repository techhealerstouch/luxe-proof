(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[522],{1243:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(9946).A)("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},2355:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(9946).A)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},2714:(e,t,s)=>{"use strict";s.d(t,{J:()=>d});var a=s(5155),n=s(2115),r=s(968),l=s(2085),i=s(3999);let c=(0,l.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)(r.b,{ref:t,className:(0,i.cn)(c(),s),...n})});d.displayName=r.b.displayName},4186:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(9946).A)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},4259:(e,t,s)=>{"use strict";s.r(t),s.d(t,{BillingPageHeader:()=>E,CreditsHistorySection:()=>en,CurrentPlanSection:()=>J,FilterSection:()=>Y,InvoiceList:()=>Q,PaginationControls:()=>es,default:()=>ed});var a=s(5155),n=s(2115),r=s(4861),l=s(5695),i=s(3301),c=s(7168),d=s(8482),o=s(9946);let u=(0,o.A)("FileDown",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]),m=e=>{if(null==e)return"";let t=String(e);return t.includes(",")||t.includes('"')||t.includes("\n")||t.includes("\r")?'"'.concat(t.replace(/"/g,'""'),'"'):t},x=(e,t)=>e&&0!==e.length?[t.map(e=>m(e)).join(","),...e.map(e=>t.map(t=>m(e[t]||"")).join(","))].join("\n"):"",h=e=>e&&0!==e.length?x(e.map((e,t)=>({id:e.id||t+1,plan_name:e.plan.name,service:e.service,amount:e.price,currency:"USD",status:e.status,start_date:e.start_date,end_date:e.end_date,description:e.plan.description||"",features:e.plan.features?e.plan.features.join("; "):""})),["id","plan_name","service","amount","currency","status","start_date","end_date","description","features"]):"",p=e=>e&&0!==e.length?x(e.map(e=>{var t;return{id:e.id,credit_name:(null===(t=e.credit)||void 0===t?void 0:t.name)||"Credits Top up",quantity:e.quantity,amount:e.amount,currency:"USD",status:e.status,created_date:e.created_at,payment_url:e.payment_url||"",description:e.description||""}}),["id","credit_name","quantity","amount","currency","status","created_date","payment_url","description"]):"",g=e=>e&&0!==e.length?x(e.map((e,t)=>({id:e.id||t+1,date:e.date||"",amount:e.amount||"",description:e.description||"",type:e.type||"",status:e.status||""})),["id","date","amount","description","type","status"]):"",f=e=>e?x([{name:e.name,type:e.type,price:e.price,billing_cycle:e.billingCycle,next_billing_date:e.nextBillingDate||"",features:e.features?e.features.join("; "):""}],["name","type","price","billing_cycle","next_billing_date","features"]):"",v=(e,t)=>{let s={};e.subscriptions&&e.subscriptions.length>0&&(s.subscriptions=h(e.subscriptions));let a=t||e.creditsInvoices||[];return a.length>0&&(s.credits_invoices=p(a)),e.billingHistory&&e.billingHistory.length>0&&(s.billing_history=g(e.billingHistory)),e.currentPlan&&(s.current_plan=f(e.currentPlan)),s},j=(e,t)=>{let s=[],a=new Date().toISOString();s.push("# Payments Export - Generated on ".concat(a)),s.push(""),e.subscriptions&&e.subscriptions.length>0&&(s.push("# SUBSCRIPTIONS"),s.push(h(e.subscriptions)),s.push(""));let n=t||e.creditsInvoices||[];return n.length>0&&(s.push("# CREDITS INVOICES"),s.push(p(n)),s.push("")),e.billingHistory&&e.billingHistory.length>0&&(s.push("# BILLING HISTORY"),s.push(g(e.billingHistory)),s.push("")),e.currentPlan&&(s.push("# CURRENT PLAN"),s.push(f(e.currentPlan))),s.join("\n")},y=(e,t)=>{try{let s=new Blob([e],{type:"text/csv;charset=utf-8;"}),a=URL.createObjectURL(s),n=document.createElement("a");n.href=a,n.download=t,n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(a)}catch(e){throw console.error("Failed to download CSV file:",e),Error("CSV download failed")}},N=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"payments_export",s=new Date().toISOString().split("T")[0],a=Object.keys(e);if(1===a.length){let n=a[0],r="".concat(t,"_").concat(n,"_").concat(s,".csv");y(e[n],r);return}a.forEach(n=>{let r="".concat(t,"_").concat(n,"_").concat(s,".csv");setTimeout(()=>{y(e[n],r)},100*a.indexOf(n))})},b=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"payments_export",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",s=new Date().toISOString().split("T")[0];return"".concat(e).concat(t?"_".concat(t):"","_").concat(s,".csv")},w=e=>{try{if(!e||0===e.trim().length)return!1;let t=e.split("\n");return t.length>0&&t[0].trim().length>0}catch(e){return console.error("CSV validation error:",e),!1}},P=async function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"combined",a=arguments.length>3?arguments[3]:void 0;try{if("separate"===s){let s=v(e,t);if(!Object.values(s).some(e=>w(e)))throw Error("No valid CSV content to export");let n=a?a.replace(".csv",""):"payments_export";N(s,n)}else{let s=j(e,t);if(!w(s))throw Error("Generated CSV content is invalid");let n=a||b();y(s,n)}}catch(e){throw console.error("CSV export failed:",e),e}};var C=s(3464),k=s(6671);let _=()=>({Authorization:"Bearer ".concat(localStorage.getItem("accessToken")),Accept:"application/json","Content-Type":"application/json"}),S="https://stg.luxevipsuite.com",I=async()=>{try{let{data:e}=await C.A.get("".concat(S,"/api/authenticator/credits/invoices"),{headers:_()});return e.success&&e.data||[]}catch(e){return console.error("Failed to fetch credits invoices:",e),[]}},D=async()=>{try{let{data:e}=await C.A.get("".concat(S,"/api/subscriptions"),{headers:_()});return"Subscriptions retrieved successfully."===e.message&&e.data||[]}catch(e){return console.error("Failed to fetch subscriptions:",e),[]}},F=e=>{window.open(e,"_blank")},A=async e=>{try{await navigator.clipboard.writeText(e),k.o.success("Invoice link copied to clipboard!")}catch(e){k.o.error("Failed to copy link")}},E=e=>{let{isDownloading:t,onDownloadCSV:s,hasData:n}=e;return(0,a.jsxs)("div",{className:"mb-6 flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-3xl font-bold tracking-tight",children:"Billing"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Manage your subscription and billing information"})]}),(0,a.jsx)(c.$,{onClick:s,disabled:t||!n,className:"rounded-xl",children:t?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"animate-spin h-4 w-4 mr-2 border-2 border-white border-t-transparent rounded-full"}),"Exporting..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(u,{className:"h-4 w-4 mr-2"}),"Export Filtered Payments (CSV)"]})})]})};var R=s(8145),L=s(1586);let M=(0,o.A)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);var T=s(646);let B=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),O=e=>new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP",minimumFractionDigits:0,maximumFractionDigits:0}).format(e);var V=s(4186),H=s(1243);let q=e=>{switch(e.toLowerCase()){case"paid":case"active":return(0,a.jsxs)(R.E,{variant:"default",className:"bg-green-100 text-green-800",children:[(0,a.jsx)(T.A,{className:"w-3 h-3 mr-1"}),"active"===e?"Active":"Paid"]});case"pending":return(0,a.jsxs)(R.E,{variant:"secondary",className:"bg-yellow-100 text-yellow-800",children:[(0,a.jsx)(V.A,{className:"w-3 h-3 mr-1"}),"Pending"]});case"failed":case"cancelled":return(0,a.jsxs)(R.E,{variant:"destructive",className:"bg-red-100 text-red-800",children:[(0,a.jsx)(H.A,{className:"w-3 h-3 mr-1"}),"cancelled"===e?"Cancelled":"Failed"]});default:return(0,a.jsx)(R.E,{variant:"outline",children:e})}},U=e=>{switch(e){case"free":return(0,a.jsx)(R.E,{variant:"secondary",children:"Free"});case"pro":return(0,a.jsx)(R.E,{variant:"default",children:"Pro"});case"enterprise":return(0,a.jsx)(R.E,{variant:"outline",children:"Enterprise"});default:return(0,a.jsx)(R.E,{variant:"outline",children:e})}},z=e=>e.find(e=>"active"===e.status||"pending"===e.status||"cancelled"!==e.status&&new Date(e.end_date)>new Date)||null,J=e=>{let{billingData:t}=e,s=()=>(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("h3",{className:"text-2xl font-bold",children:(null==t?void 0:t.currentPlan.name)||"Free Plan"}),U((null==t?void 0:t.currentPlan.type)||"free")]}),(0,a.jsxs)("div",{className:"flex items-baseline gap-1",children:[(0,a.jsx)("span",{className:"text-3xl font-bold",children:O((null==t?void 0:t.currentPlan.price)||0)}),(0,a.jsxs)("span",{className:"text-muted-foreground",children:["/",(null==t?void 0:t.currentPlan.billingCycle)||"month"]})]}),(null==t?void 0:t.currentPlan.nextBillingDate)&&(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[(0,a.jsx)(M,{className:"h-4 w-4"}),"Next billing date:"," ",B(t.currentPlan.nextBillingDate)]})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("h4",{className:"font-medium",children:"Plan Features:"}),(0,a.jsx)("ul",{className:"space-y-2",children:((null==t?void 0:t.currentPlan.features)||[]).map((e,t)=>(0,a.jsxs)("li",{className:"flex items-center gap-2 text-sm",children:[(0,a.jsx)(T.A,{className:"h-4 w-4 text-green-500"}),e]},t))})]})]});return(0,a.jsxs)(d.Zp,{children:[(0,a.jsxs)(d.aR,{children:[(0,a.jsxs)(d.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(L.A,{className:"h-5 w-5"}),"Current Plan"]}),(0,a.jsx)(d.BT,{children:"Your current subscription plan and usage"})]}),(0,a.jsx)(d.Wu,{children:(()=>{if(!(null==t?void 0:t.subscriptions)||0===t.subscriptions.length)return s();let e=z(t.subscriptions);return e?(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("h3",{className:"text-2xl font-bold",children:e.plan.name}),q(e.status)]}),(0,a.jsxs)("div",{className:"flex items-baseline gap-1",children:[(0,a.jsx)("span",{className:"text-3xl font-bold",children:O(e.price)}),(0,a.jsx)("span",{className:"text-muted-foreground",children:"/subscription"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[(0,a.jsx)(M,{className:"h-4 w-4"}),"Started: ",B(e.start_date)]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[(0,a.jsx)(M,{className:"h-4 w-4"}),"Ends: ",B(e.end_date)]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,a.jsx)("span",{className:"font-medium",children:"Service:"}),(0,a.jsx)(R.E,{variant:"outline",children:e.service})]})]})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("h4",{className:"font-medium",children:"Plan Features:"}),e.plan.features&&e.plan.features.length>0?(0,a.jsx)("ul",{className:"space-y-2",children:e.plan.features.map((e,t)=>(0,a.jsxs)("li",{className:"flex items-center gap-2 text-sm",children:[(0,a.jsx)(T.A,{className:"h-4 w-4 text-green-500"}),e]},t))}):(0,a.jsx)("div",{className:"space-y-2",children:(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:e.plan.description||"No description available"})})]})]}):(0,a.jsxs)("div",{className:"text-center py-6",children:[(0,a.jsx)(L.A,{className:"h-12 w-12 mx-auto text-muted-foreground mb-3"}),(0,a.jsx)("p",{className:"text-muted-foreground mb-4",children:"No active subscription found"})]})})()})]})};var $=s(9852),Z=s(2714),W=s(5784);let G=(0,o.A)("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),Y=e=>{let{showFilters:t,filters:s,onFilterChange:n,onResetFilters:r,statusOptions:l}=e;return t?(0,a.jsx)("div",{className:"mt-4 p-4 border rounded-xl bg-muted/20",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(Z.J,{htmlFor:"start-date",children:"Start Date"}),(0,a.jsx)($.p,{id:"start-date",type:"date",value:s.startDate,onChange:e=>n("startDate",e.target.value),className:"rounded-xl"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(Z.J,{htmlFor:"end-date",children:"End Date"}),(0,a.jsx)($.p,{id:"end-date",type:"date",value:s.endDate,onChange:e=>n("endDate",e.target.value),className:"rounded-xl"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(Z.J,{htmlFor:"status-filter",children:"Status"}),(0,a.jsxs)(W.l6,{value:s.status,onValueChange:e=>n("status",e),children:[(0,a.jsx)(W.bq,{className:"rounded-xl",children:(0,a.jsx)(W.yv,{placeholder:"Select status"})}),(0,a.jsxs)(W.gC,{children:[(0,a.jsx)(W.eb,{value:"all",children:"All Statuses"}),l.map(e=>(0,a.jsx)(W.eb,{value:e.value,children:e.label},e.value))]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(Z.J,{children:"\xa0"}),(0,a.jsxs)(c.$,{variant:"outline",onClick:r,className:"w-full rounded-xl",children:[(0,a.jsx)(G,{className:"h-4 w-4 mr-2"}),"Reset"]})]})]})}):null};var X=s(3786);let K=(0,o.A)("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),Q=e=>{let{invoices:t,onDownloadInvoice:s}=e;return(0,a.jsx)("div",{className:"space-y-4",children:t.map(e=>{var t;return(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 border rounded-xl",children:[(0,a.jsx)("div",{className:"flex items-center gap-4",children:(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"font-medium",children:[(null===(t=e.credit)||void 0===t?void 0:t.name)||"Credits Top up"," - ",e.quantity," ","credits"]}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:B(e.created_at)})]})}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("p",{className:"font-medium",children:O(e.amount)}),q(e.status)]}),(0,a.jsx)("div",{className:"flex gap-2",children:e.payment_url&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(c.$,{variant:"ghost",size:"sm",onClick:()=>F(e.payment_url),className:"rounded-xl",title:"Open invoice link",children:(0,a.jsx)(X.A,{className:"h-4 w-4"})}),(0,a.jsx)(c.$,{variant:"ghost",size:"sm",onClick:()=>A(e.payment_url),className:"rounded-xl",title:"Copy invoice link",children:(0,a.jsx)(K,{className:"h-4 w-4"})})]})})]})]},e.id)})})};var ee=s(2355),et=s(3052);let es=e=>{let{pagination:t,onPageChange:s,onItemsPerPageChange:n}=e;return t.totalPages<=1?null:(0,a.jsxs)("div",{className:"mt-6 flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(Z.J,{htmlFor:"items-per-page",children:"Items per page:"}),(0,a.jsxs)(W.l6,{value:t.itemsPerPage.toString(),onValueChange:n,children:[(0,a.jsx)(W.bq,{className:"w-20 rounded-xl",children:(0,a.jsx)(W.yv,{})}),(0,a.jsxs)(W.gC,{children:[(0,a.jsx)(W.eb,{value:"5",children:"5"}),(0,a.jsx)(W.eb,{value:"10",children:"10"}),(0,a.jsx)(W.eb,{value:"20",children:"20"}),(0,a.jsx)(W.eb,{value:"50",children:"50"})]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(c.$,{variant:"outline",size:"sm",onClick:()=>s(t.currentPage-1),disabled:1===t.currentPage,className:"rounded-xl",title:"Previous page",children:(0,a.jsx)(ee.A,{className:"h-4 w-4"})}),(0,a.jsxs)("span",{className:"text-sm text-muted-foreground",children:["Page ",t.currentPage," of ",t.totalPages]}),(0,a.jsx)(c.$,{variant:"outline",size:"sm",onClick:()=>s(t.currentPage+1),disabled:t.currentPage===t.totalPages,className:"rounded-xl",title:"Next page",children:(0,a.jsx)(et.A,{className:"h-4 w-4"})})]})]})},ea=(0,o.A)("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]),en=e=>{let{billingData:t,filteredInvoices:s,paginatedInvoices:n,pagination:r,filters:l,showFilters:i,onToggleFilters:o,onFilterChange:u,onResetFilters:m,onPageChange:x,onItemsPerPageChange:h,onDownloadInvoice:p,statusOptions:g}=e;return(0,a.jsxs)(d.Zp,{children:[(0,a.jsxs)(d.aR,{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(d.ZB,{className:"flex items-center gap-2",children:"Credits Invoice History"}),(0,a.jsxs)(d.BT,{children:["View your credits invoices (",s.length," of"," ",(null==t?void 0:t.creditsInvoices.length)||0," total)"]})]}),(0,a.jsxs)(c.$,{variant:"outline",size:"sm",onClick:o,className:"rounded-xl",children:[(0,a.jsx)(ea,{className:"h-4 w-4 mr-2"}),i?"Hide":"Show"," Filters"]})]}),(0,a.jsx)(Y,{showFilters:i,filters:l,onFilterChange:u,onResetFilters:m,statusOptions:g})]}),(0,a.jsx)(d.Wu,{children:n.length?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(Q,{invoices:n,onDownloadInvoice:p}),(0,a.jsx)(es,{pagination:r,onPageChange:x,onItemsPerPageChange:h})]}):(0,a.jsxs)("div",{className:"text-center py-6",children:[(0,a.jsx)("p",{className:"text-muted-foreground mb-4",children:(null==t?void 0:t.creditsInvoices.length)?"No invoices match your current filters":"No credits invoices available"}),(null==t?void 0:t.creditsInvoices.length)&&(0,a.jsxs)(c.$,{variant:"outline",onClick:m,className:"rounded-xl",children:[(0,a.jsx)(G,{className:"h-4 w-4 mr-2"}),"Clear Filters"]})]})})]})},er={currentPlan:{name:"Free Plan",type:"free",price:0,billingCycle:"monthly",features:["Basic features","Limited usage","Community support"]},billingHistory:[],creditsInvoices:[],subscriptions:[]},el=(e,t)=>e.filter(e=>{let s=new Date(e.created_at),a=t.startDate?new Date(t.startDate):null,n=t.endDate?new Date(t.endDate):null;return(!a||!(s<a))&&(!n||!(s>n))&&(!t.status||"all"===t.status||e.status.toLowerCase()===t.status.toLowerCase())}),ei=(e,t,s)=>{let a=(t-1)*s;return e.slice(a,a+s)},ec=e=>{let{isDownloading:t,onDownloadXML:s,hasData:n}=e;return(0,a.jsxs)("div",{className:"mb-6 flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-3xl font-bold tracking-tight",children:"Billing"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Manage your subscription and billing information"})]}),(0,a.jsx)(c.$,{onClick:s,disabled:t||!n,className:"rounded-xl",children:t?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"animate-spin h-4 w-4 mr-2 border-2 border-white border-t-transparent rounded-full"}),"Exporting..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(u,{className:"h-4 w-4 mr-2"}),"Export Filtered Payments (CSV)"]})})]})};function ed(){let{user:e}=(0,r.A)(),t=(0,l.useRouter)(),[s,c]=(0,n.useState)(null),[o,u]=(0,n.useState)(!0),[m,x]=(0,n.useState)(!1),[h,p]=(0,n.useState)({currentPage:1,itemsPerPage:5,totalItems:0,totalPages:0}),[g,f]=(0,n.useState)({startDate:"",endDate:"",status:"all"}),[v,j]=(0,n.useState)(!1),{filteredInvoices:y,paginatedInvoices:N}=(0,n.useMemo)(()=>{if(!(null==s?void 0:s.creditsInvoices))return{filteredInvoices:[],paginatedInvoices:[]};let e=el(s.creditsInvoices,g),t=Math.ceil(e.length/h.itemsPerPage);p(s=>({...s,totalItems:e.length,totalPages:t,currentPage:s.currentPage>t?1:s.currentPage}));let a=ei(e,h.currentPage,h.itemsPerPage);return{filteredInvoices:e,paginatedInvoices:a}},[null==s?void 0:s.creditsInvoices,g,h.currentPage,h.itemsPerPage]),b=async()=>{if(s){x(!0);try{await P(s,y,"combined")}catch(e){console.error("Failed to download CSV:",e)}finally{x(!1)}}};return((0,n.useEffect)(()=>{if(!e){t.push("/login");return}(async()=>{u(!0);try{let[e,t]=await Promise.all([I(),D()]);c({...er,creditsInvoices:e,subscriptions:t})}catch(e){console.error("Failed to fetch billing data:",e)}finally{u(!1)}})()},[e,t]),e)?o?(0,a.jsx)(i.A,{children:(0,a.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h2",{className:"text-3xl font-bold tracking-tight",children:"Billing"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Loading billing information..."})]}),(0,a.jsx)("div",{className:"grid gap-6",children:[1,2,3].map(e=>(0,a.jsx)(d.Zp,{children:(0,a.jsx)(d.Wu,{className:"p-6",children:(0,a.jsxs)("div",{className:"animate-pulse space-y-4",children:[(0,a.jsx)("div",{className:"h-4 bg-muted rounded w-1/4"}),(0,a.jsx)("div",{className:"h-8 bg-muted rounded w-1/2"}),(0,a.jsx)("div",{className:"h-4 bg-muted rounded w-3/4"})]})})},e))})]})}):(0,a.jsx)(i.A,{children:(0,a.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,a.jsx)(ec,{isDownloading:m,onDownloadXML:b,hasData:!!s}),(0,a.jsxs)("div",{className:"grid gap-6",children:[(0,a.jsx)(J,{billingData:s}),(0,a.jsx)(en,{billingData:s,filteredInvoices:y,paginatedInvoices:N,pagination:h,filters:g,showFilters:v,onToggleFilters:()=>j(!v),onFilterChange:(e,t)=>{f(s=>({...s,[e]:t})),p(e=>({...e,currentPage:1}))},onResetFilters:()=>{f({startDate:"",endDate:"",status:"all"}),p(e=>({...e,currentPage:1}))},onPageChange:e=>{p(t=>({...t,currentPage:e}))},onItemsPerPageChange:e=>{p(t=>({...t,itemsPerPage:parseInt(e),currentPage:1}))},onDownloadInvoice:e=>{console.log("Download invoice:",e)},statusOptions:(null==s?void 0:s.creditsInvoices)?[...new Set(s.creditsInvoices.map(e=>e.status))].map(e=>({value:e.toLowerCase(),label:e})):[]})]})]})}):null}},5784:(e,t,s)=>{"use strict";s.d(t,{bq:()=>m,eb:()=>g,gC:()=>p,l6:()=>o,mi:()=>f,yv:()=>u});var a=s(5155),n=s(2115),r=s(2918),l=s(6474),i=s(7863),c=s(5196),d=s(3999);let o=r.bL;r.YJ;let u=r.WT,m=n.forwardRef((e,t)=>{let{className:s,children:n,...i}=e;return(0,a.jsxs)(r.l9,{ref:t,className:(0,d.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",s),...i,children:[n,(0,a.jsx)(r.In,{asChild:!0,children:(0,a.jsx)(l.A,{className:"h-4 w-4 opacity-50"})})]})});m.displayName=r.l9.displayName;let x=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)(r.PP,{ref:t,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",s),...n,children:(0,a.jsx)(i.A,{className:"h-4 w-4"})})});x.displayName=r.PP.displayName;let h=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)(r.wn,{ref:t,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",s),...n,children:(0,a.jsx)(l.A,{className:"h-4 w-4"})})});h.displayName=r.wn.displayName;let p=n.forwardRef((e,t)=>{let{className:s,children:n,position:l="popper",...i}=e;return(0,a.jsx)(r.ZL,{children:(0,a.jsxs)(r.UC,{ref:t,className:(0,d.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===l&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:l,...i,children:[(0,a.jsx)(x,{}),(0,a.jsx)(r.LM,{className:(0,d.cn)("p-1","popper"===l&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:n}),(0,a.jsx)(h,{})]})})});p.displayName=r.UC.displayName,n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)(r.JU,{ref:t,className:(0,d.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",s),...n})}).displayName=r.JU.displayName;let g=n.forwardRef((e,t)=>{let{className:s,children:n,...l}=e;return(0,a.jsxs)(r.q7,{ref:t,className:(0,d.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...l,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(r.VF,{children:(0,a.jsx)(c.A,{className:"h-4 w-4"})})}),(0,a.jsx)(r.p4,{children:n})]})});g.displayName=r.q7.displayName;let f=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)(r.wv,{ref:t,className:(0,d.cn)("-mx-1 my-1 h-px bg-muted",s),...n})});f.displayName=r.wv.displayName},8654:(e,t,s)=>{Promise.resolve().then(s.bind(s,4259))},9852:(e,t,s)=>{"use strict";s.d(t,{p:()=>l});var a=s(5155),n=s(2115),r=s(3999);let l=n.forwardRef((e,t)=>{let{className:s,type:n,...l}=e;return(0,a.jsx)("input",{type:n,className:(0,r.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:t,...l})});l.displayName="Input"}},e=>{var t=t=>e(e.s=t);e.O(0,[803,374,356,208,256,815,15,301,441,684,358],()=>t(8654)),_N_E=e.O()}]);