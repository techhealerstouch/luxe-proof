(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4049],{10072:(e,t,a)=>{"use strict";a.d(t,{A:()=>n});var r=a(95155),s=a(66766);let o={src:"/_next/static/media/logo.280af7fc.svg",height:219,width:1070,blurWidth:0,blurHeight:0};function n(e){let{width:t=120,height:a=60,className:n}=e;return(0,r.jsx)(s.default,{src:o,alt:"Company Logo",width:t,height:a,className:n,priority:!0})}},49026:(e,t,a)=>{"use strict";a.d(t,{Fc:()=>l,TN:()=>d,XL:()=>c});var r=a(95155),s=a(12115),o=a(74466),n=a(53999);let i=(0,o.F)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),l=s.forwardRef((e,t)=>{let{className:a,variant:s,...o}=e;return(0,r.jsx)("div",{ref:t,role:"alert",className:(0,n.cn)(i({variant:s}),a),...o})});l.displayName="Alert";let c=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("h5",{ref:t,className:(0,n.cn)("mb-1 font-medium leading-none tracking-tight",a),...s})});c.displayName="AlertTitle";let d=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("text-sm [&_p]:leading-relaxed",a),...s})});d.displayName="AlertDescription"},51154:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(19946).A)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},53999:(e,t,a)=>{"use strict";a.d(t,{cn:()=>o});var r=a(52596),s=a(39688);function o(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,s.QP)((0,r.$)(t))}},62600:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>w});var r=a(95155),s=a(35695),o=a(6874),n=a.n(o),i=a(97168),l=a(88482),c=a(76037),d=a(66766),u=a(12115),h=a(94861),f=a(88006),g=a(49026),m=a(85339),p=a(10072);function x(e){return btoa(String.fromCharCode(...e)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function v(e){let t=new TextEncoder().encode(e);return x(new Uint8Array(await window.crypto.subtle.digest("SHA-256",t)))}function w(){let e=(0,s.useRouter)(),t=(0,s.useSearchParams)(),{user:a,isLoading:o}=(0,h.A)(),[w,y]=(0,u.useState)(null),[b,N]=(0,u.useState)(!1);(0,u.useEffect)(()=>{let r=t.get("error");if(r)switch(r){case"oauth_failed":y("OAuth authentication failed. Please try again.");break;case"no_code":y("Authentication incomplete. Please try again.");break;case"auth_failed":y("Authentication failed. Please check your credentials.");break;default:y("An error occurred. Please try again.")}if(!o&&a){let a=t.get("from")||"/dashboard";e.push(a)}},[a,o,e,t]);let S=async()=>{N(!0);let e=function(){let e=new Uint8Array(32);return window.crypto.getRandomValues(e),x(e)}(),t=await v(e);localStorage.setItem("pkce_code_verifier",e);let a=new URLSearchParams({response_type:"code",client_id:"01998003-aa09-70b2-a106-1fd34098f380",redirect_uri:"".concat("https://stgapp.luxeproof.com","/auth/callback"),scope:"",code_challenge:t,code_challenge_method:"S256"}),r="".concat("https://stg.luxevipsuite.com","/oauth/authorize?").concat(a.toString());window.location.href=r};return o||a?(0,r.jsx)(f.n,{}):b?(0,r.jsxs)("div",{className:"flex h-screen items-center justify-center flex-col gap-4 bg-gray-50",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-700"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Redirecting to Lux Suite..."})]}):(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:(0,r.jsxs)("div",{className:"flex flex-col md:flex-row bg-white rounded-2xl shadow-lg overflow-hidden w-full max-w-4xl",children:[(0,r.jsx)("div",{className:"relative w-full md:w-1/2 h-48 md:h-auto",children:(0,r.jsx)(d.default,{src:"/images/watch-login.png",alt:"Login illustration",fill:!0,className:"object-cover",priority:!0})}),(0,r.jsx)("div",{className:"flex items-center justify-center w-full md:w-1/2 p-8",children:(0,r.jsxs)(l.Zp,{className:"w-full border-none shadow-none",children:[(0,r.jsxs)(l.aR,{className:"space-y-1",children:[(0,r.jsx)(l.ZB,{className:"text-center text-3xl font-extrabold tracking-tight text-gray-900",children:(0,r.jsx)(p.A,{width:350,height:80,className:"mx-auto"})}),(0,r.jsx)(l.BT,{className:"text-left leading-relaxed text-center",children:"To access your personalized dashboard and manage your Lux Suite account"})]}),(0,r.jsxs)(l.Wu,{className:"space-y-6",children:[w&&(0,r.jsxs)(g.Fc,{variant:"destructive",children:[(0,r.jsx)(m.A,{className:"h-4 w-4"}),(0,r.jsx)(g.TN,{children:w})]}),(0,r.jsxs)("div",{className:"relative w-full",children:[(0,r.jsx)("div",{className:"absolute inset-0 flex items-center",children:(0,r.jsx)(c.Separator,{className:"w-full"})}),(0,r.jsx)("div",{className:"relative flex justify-center text-xs uppercase",children:(0,r.jsx)("span",{className:"bg-background px-2 text-muted-foreground",children:"Continue with"})})]}),(0,r.jsx)(i.$,{variant:"outline",type:"button",className:"w-full rounded-xl bg-main-bg",onClick:S,disabled:b,children:b?(0,r.jsxs)("span",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-gray-700"}),"Redirecting..."]}):"Log-in with Lux Suite"})]}),(0,r.jsx)(l.wL,{className:"flex flex-col items-center space-y-4",children:(0,r.jsxs)("p",{className:"text-xs text-gray-500",children:["Need support?"," ",(0,r.jsx)(n(),{href:"/support",className:"underline",children:"Contact our help team"})]})})]})})]})})}},76037:(e,t,a)=>{"use strict";a.d(t,{Separator:()=>i});var r=a(95155),s=a(12115),o=a(87489),n=a(53999);let i=s.forwardRef((e,t)=>{let{className:a,orientation:s="horizontal",decorative:i=!0,...l}=e;return(0,r.jsx)(o.b,{ref:t,decorative:i,orientation:s,className:(0,n.cn)("shrink-0 bg-border","horizontal"===s?"h-[1px] w-full":"h-full w-[1px]",a),...l})});i.displayName=o.b.displayName},85339:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(19946).A)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},87489:(e,t,a)=>{"use strict";a.d(t,{b:()=>c});var r=a(12115),s=a(63655),o=a(95155),n="horizontal",i=["horizontal","vertical"],l=r.forwardRef((e,t)=>{var a;let{decorative:r,orientation:l=n,...c}=e,d=(a=l,i.includes(a))?l:n;return(0,o.jsx)(s.sG.div,{"data-orientation":d,...r?{role:"none"}:{"aria-orientation":"vertical"===d?d:void 0,role:"separator"},...c,ref:t})});l.displayName="Separator";var c=l},88006:(e,t,a)=>{"use strict";a.d(t,{n:()=>o});var r=a(95155),s=a(51154);function o(){return(0,r.jsxs)("div",{className:"flex h-screen items-center justify-center flex-col gap-4 bg-background",children:[(0,r.jsx)(s.A,{className:"h-8 w-8 animate-spin text-primary"}),(0,r.jsx)("p",{className:"text-gray-600 font-medium",children:"Loading..."})]})}},88482:(e,t,a)=>{"use strict";a.d(t,{BT:()=>c,Wu:()=>d,ZB:()=>l,Zp:()=>n,aR:()=>i,wL:()=>u});var r=a(95155),s=a(12115),o=a(53999);let n=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,o.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",a),...s})});n.displayName="Card";let i=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,o.cn)("flex flex-col space-y-1.5 p-6",a),...s})});i.displayName="CardHeader";let l=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,o.cn)("text-2xl font-semibold leading-none tracking-tight",a),...s})});l.displayName="CardTitle";let c=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,o.cn)("text-sm text-muted-foreground",a),...s})});c.displayName="CardDescription";let d=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,o.cn)("p-6 pt-0",a),...s})});d.displayName="CardContent";let u=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,o.cn)("flex items-center p-6 pt-0",a),...s})});u.displayName="CardFooter"},89778:(e,t,a)=>{Promise.resolve().then(a.bind(a,62600))},94861:(e,t,a)=>{"use strict";a.d(t,{A:()=>h,AuthProvider:()=>u});var r=a(95155),s=a(12115),o=a(35695),n=a(23464),i=a(56671);let l={ACCESS_TOKEN:"accessToken",REFRESH_TOKEN:"refreshToken",USER:"user",LOGGED_IN:"loggedIn",JUST_LOGGED_IN:"justLoggedIn",AUTH_TOKEN:"auth_token",PKCE_VERIFIER:"pkce_code_verifier"},c={LOGIN:"/login",DASHBOARD:"/dashboard"},d=(0,s.createContext)(null);function u(e){let{children:t}=e,[a,u]=(0,s.useState)(null),[h,f]=(0,s.useState)(!0),g=(0,o.useRouter)(),m="https://stg.luxevipsuite.com",p=(0,s.useCallback)(()=>{Object.values(l).forEach(e=>{localStorage.removeItem(e),sessionStorage.removeItem(e)})},[]),x=(0,s.useCallback)(e=>{sessionStorage.setItem(l.USER,JSON.stringify(e)),sessionStorage.setItem(l.LOGGED_IN,"true"),u(e)},[]),v=(0,s.useCallback)(()=>{try{let e=sessionStorage.getItem(l.USER);if(!e)return null;let t=JSON.parse(e);return t.data||t}catch(e){return console.error("Failed to parse stored user:",e),sessionStorage.removeItem(l.USER),null}},[]),w=(0,s.useCallback)(async e=>{let t=localStorage.getItem(l.PKCE_VERIFIER);if(!t)throw Error("PKCE code verifier missing. Please start the login process again.");let a=new URLSearchParams({grant_type:"authorization_code",client_id:"01998003-aa09-70b2-a106-1fd34098f380",redirect_uri:"".concat("https://stgapp.luxeproof.com","/auth/callback"),code:e,code_verifier:t});try{let e=await fetch("".concat(m,"/oauth/token"),{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"},body:a.toString()}),t=await e.json();if(!e.ok)throw console.error("OAuth token error response:",t),Error(t.error_description||"Failed to exchange authorization code");return localStorage.removeItem(l.PKCE_VERIFIER),t}catch(e){throw console.error("Token exchange failed:",e),e}},[m]),y=(0,s.useCallback)(async()=>{try{let e=await fetch("".concat(m,"/api/refresh-token"),{method:"POST",credentials:"include",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!e.ok)throw Error("Failed to refresh token");return(await e.json()).access_token}catch(e){throw console.error("Token refresh failed:",e),window.location.href=c.LOGIN,e}},[m]),b=(0,s.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=localStorage.getItem(l.ACCESS_TOKEN);if(!t)throw Error("No access token available");try{let a=await fetch("".concat(m,"/api/user"),{method:"GET",headers:{Authorization:"Bearer ".concat(t),Accept:"application/json","Content-Type":"application/json"}});if(!a.ok){if(401===a.status){let t=await y();return localStorage.setItem(l.ACCESS_TOKEN,t),b(e)}throw Error("Failed to fetch user data")}let r=await a.json(),s=r.data||r;return x(s),sessionStorage.getItem(l.JUST_LOGGED_IN)&&(i.o.success("Logged in successfully!"),sessionStorage.removeItem(l.JUST_LOGGED_IN)),e&&g.push(c.DASHBOARD),s}catch(e){throw console.error("Error fetching user data:",e),e}},[m,y,g,x]),N=(0,s.useCallback)(async e=>{let t=localStorage.getItem(l.ACCESS_TOKEN);if(!t)throw Error("No auth token found");console.log(e);let a={name:e.name,email:e.email,phone_number:e.phone_number,timezone:e.timezone,account:{name:e.businessName,slug:e.businessSlug}};try{let e=await n.A.put("".concat(m,"/api/user"),a,{headers:{Authorization:"Bearer ".concat(t),Accept:"application/json","Content-Type":"application/json"}}),r=e.data.data||e.data;return x(r),i.o.success("Watch data submitted successfully"),r}catch(e){throw i.o.error("Profile Update Failed!"),e}},[m,x]),S=(0,s.useCallback)(()=>{let e=localStorage.getItem(l.ACCESS_TOKEN),t=sessionStorage.getItem(l.USER);return!!(e&&t)},[]),j=(0,s.useCallback)(async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=localStorage.getItem(l.ACCESS_TOKEN);if(!a)throw Error("No access token available");let r=async a=>fetch(e,{...t,headers:{...t.headers,Authorization:"Bearer ".concat(a),Accept:"application/json","Content-Type":"application/json"}}),s=await r(a);if(401===s.status)try{let e=await y();return localStorage.setItem(l.ACCESS_TOKEN,e),r(e)}catch(e){throw await C(),e}return s},[y]),E=(0,s.useCallback)(async(e,t,a)=>{console.log(e);let r=localStorage.getItem(l.ACCESS_TOKEN);try{let s=await j("".concat(m,"/api/user/change-password"),{headers:{Authorization:"Bearer ".concat(r),Accept:"application/json","Content-Type":"application/json"},method:"PUT",credentials:"include",body:JSON.stringify({currentPassword:e,newPassword:t,newPassword_confirmation:a})});if(!s.ok){let e=await s.json();throw Error(e.message||"Failed to change password")}i.o.success("Password changed successfully!")}catch(e){throw i.o.error(e.message||"Password change failed"),e}},[j,m]),C=(0,s.useCallback)(async()=>{try{let e=localStorage.getItem(l.ACCESS_TOKEN);e&&await fetch("".concat(m,"/api/logout"),{method:"POST",credentials:"include",headers:{Accept:"application/json",Authorization:"Bearer ".concat(e)}})}catch(e){console.error("Logout API call failed:",e)}finally{p(),u(null),window.location.href=c.LOGIN}},[m,p]);return((0,s.useEffect)(()=>{(async()=>{try{let e=localStorage.getItem(l.ACCESS_TOKEN);if(sessionStorage.getItem(l.JUST_LOGGED_IN)&&e){await b(!0);return}let t=v();if(t){u(t),window.location.pathname===c.LOGIN&&g.push(c.DASHBOARD);return}if(e)try{await b(!0)}catch(e){console.error("Failed to restore session:",e),localStorage.removeItem(l.ACCESS_TOKEN)}}catch(e){console.error("Auth initialization error:",e)}finally{f(!1)}})()},[]),h)?(0,r.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:"Loading..."}):(0,r.jsx)(d.Provider,{value:{user:a,isLoading:h,logout:C,updateUser:N,changePassword:E,exchangeAuthorizationCode:w,refreshAccessToken:y,fetchUserData:b,isAuthenticated:S,authenticatedRequest:j},children:t})}let h=()=>{let e=(0,s.useContext)(d);if(!e)throw Error("useAuth must be used within an AuthProvider");return e}},97168:(e,t,a)=>{"use strict";a.d(t,{$:()=>c,r:()=>l});var r=a(95155),s=a(12115),o=a(99708),n=a(74466),i=a(53999);let l=(0,n.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=s.forwardRef((e,t)=>{let{className:a,variant:s,size:n,asChild:c=!1,...d}=e,u=c?o.DX:"button";return(0,r.jsx)(u,{className:(0,i.cn)(l({variant:s,size:n,className:a})),ref:t,...d})});c.displayName="Button"}},e=>{var t=t=>e(e.s=t);e.O(0,[794,6803,6671,6356,6766,8441,1684,7358],()=>t(89778)),_N_E=e.O()}]);