(()=>{var e={};e.id=991,e.ids=[991],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},6264:(e,t,s)=>{"use strict";s.r(t),s.d(t,{BillingPageHeader:()=>a,CreditsHistorySection:()=>c,CurrentPlanSection:()=>n,FilterSection:()=>i,InvoiceList:()=>l,PaginationControls:()=>o,default:()=>d});var r=s(12907);let a=(0,r.registerClientReference)(function(){throw Error("Attempted to call BillingPageHeader() from the server but BillingPageHeader is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\lagtn\\Documents\\luxeproof\\app\\(main)\\billing\\page.tsx","BillingPageHeader"),n=(0,r.registerClientReference)(function(){throw Error("Attempted to call CurrentPlanSection() from the server but CurrentPlanSection is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\lagtn\\Documents\\luxeproof\\app\\(main)\\billing\\page.tsx","CurrentPlanSection"),i=(0,r.registerClientReference)(function(){throw Error("Attempted to call FilterSection() from the server but FilterSection is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\lagtn\\Documents\\luxeproof\\app\\(main)\\billing\\page.tsx","FilterSection"),l=(0,r.registerClientReference)(function(){throw Error("Attempted to call InvoiceList() from the server but InvoiceList is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\lagtn\\Documents\\luxeproof\\app\\(main)\\billing\\page.tsx","InvoiceList"),o=(0,r.registerClientReference)(function(){throw Error("Attempted to call PaginationControls() from the server but PaginationControls is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\lagtn\\Documents\\luxeproof\\app\\(main)\\billing\\page.tsx","PaginationControls"),c=(0,r.registerClientReference)(function(){throw Error("Attempted to call CreditsHistorySection() from the server but CreditsHistorySection is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\lagtn\\Documents\\luxeproof\\app\\(main)\\billing\\page.tsx","CreditsHistorySection"),d=(0,r.registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\Users\\\\lagtn\\\\Documents\\\\luxeproof\\\\app\\\\(main)\\\\billing\\\\page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\lagtn\\Documents\\luxeproof\\app\\(main)\\billing\\page.tsx","default")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},12412:e=>{"use strict";e.exports=require("assert")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},27910:e=>{"use strict";e.exports=require("stream")},28354:e=>{"use strict";e.exports=require("util")},29021:e=>{"use strict";e.exports=require("fs")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33642:(e,t,s)=>{"use strict";s.r(t),s.d(t,{BillingPageHeader:()=>_,CreditsHistorySection:()=>K,CurrentPlanSection:()=>M,FilterSection:()=>V,InvoiceList:()=>Z,PaginationControls:()=>W,default:()=>es});var r=s(60687),a=s(43210),n=s(15527),i=s(16189),l=s(37139),o=s(24934),c=s(55192),d=s(62688);let u=(0,d.A)("FileDown",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]),m=e=>{if(null==e)return"";let t=String(e);return t.includes(",")||t.includes('"')||t.includes("\n")||t.includes("\r")?`"${t.replace(/"/g,'""')}"`:t},p=(e,t)=>e&&0!==e.length?[t.map(e=>m(e)).join(","),...e.map(e=>t.map(t=>m(e[t]||"")).join(","))].join("\n"):"",x=e=>e&&0!==e.length?p(e.map((e,t)=>({id:e.id||t+1,plan_name:e.plan.name,service:e.service,amount:e.price,currency:"USD",status:e.status,start_date:e.start_date,end_date:e.end_date,description:e.plan.description||"",features:e.plan.features?e.plan.features.join("; "):""})),["id","plan_name","service","amount","currency","status","start_date","end_date","description","features"]):"",h=e=>e&&0!==e.length?p(e.map(e=>({id:e.id,credit_name:e.credit?.name||"Credits Top up",quantity:e.quantity,amount:e.amount,currency:"USD",status:e.status,created_date:e.created_at,payment_url:e.payment_url||"",description:e.description||""})),["id","credit_name","quantity","amount","currency","status","created_date","payment_url","description"]):"",g=e=>e&&0!==e.length?p(e.map((e,t)=>({id:e.id||t+1,date:e.date||"",amount:e.amount||"",description:e.description||"",type:e.type||"",status:e.status||""})),["id","date","amount","description","type","status"]):"",f=e=>e?p([{name:e.name,type:e.type,price:e.price,billing_cycle:e.billingCycle,next_billing_date:e.nextBillingDate||"",features:e.features?e.features.join("; "):""}],["name","type","price","billing_cycle","next_billing_date","features"]):"",v=(e,t)=>{let s={};e.subscriptions&&e.subscriptions.length>0&&(s.subscriptions=x(e.subscriptions));let r=t||e.creditsInvoices||[];return r.length>0&&(s.credits_invoices=h(r)),e.billingHistory&&e.billingHistory.length>0&&(s.billing_history=g(e.billingHistory)),e.currentPlan&&(s.current_plan=f(e.currentPlan)),s},j=(e,t)=>{let s=[],r=new Date().toISOString();s.push(`# Payments Export - Generated on ${r}`),s.push(""),e.subscriptions&&e.subscriptions.length>0&&(s.push("# SUBSCRIPTIONS"),s.push(x(e.subscriptions)),s.push(""));let a=t||e.creditsInvoices||[];return a.length>0&&(s.push("# CREDITS INVOICES"),s.push(h(a)),s.push("")),e.billingHistory&&e.billingHistory.length>0&&(s.push("# BILLING HISTORY"),s.push(g(e.billingHistory)),s.push("")),e.currentPlan&&(s.push("# CURRENT PLAN"),s.push(f(e.currentPlan))),s.join("\n")},y=(e,t)=>{try{let s=new Blob([e],{type:"text/csv;charset=utf-8;"}),r=URL.createObjectURL(s),a=document.createElement("a");a.href=r,a.download=t,a.style.display="none",document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(r)}catch(e){throw console.error("Failed to download CSV file:",e),Error("CSV download failed")}},b=(e,t="payments_export")=>{let s=new Date().toISOString().split("T")[0],r=Object.keys(e);if(1===r.length){let a=r[0],n=`${t}_${a}_${s}.csv`;y(e[a],n);return}r.forEach(a=>{let n=`${t}_${a}_${s}.csv`;setTimeout(()=>{y(e[a],n)},100*r.indexOf(a))})},N=(e="payments_export",t="")=>{let s=new Date().toISOString().split("T")[0],r=t?`_${t}`:"";return`${e}${r}_${s}.csv`},w=e=>{try{if(!e||0===e.trim().length)return!1;let t=e.split("\n");return t.length>0&&t[0].trim().length>0}catch(e){return console.error("CSV validation error:",e),!1}},C=async(e,t,s="combined",r)=>{try{if("separate"===s){let s=v(e,t);if(!Object.values(s).some(e=>w(e)))throw Error("No valid CSV content to export");let a=r?r.replace(".csv",""):"payments_export";b(s,a)}else{let s=j(e,t);if(!w(s))throw Error("Generated CSV content is invalid");let a=r||N();y(s,a)}}catch(e){throw console.error("CSV export failed:",e),e}};s(51060);var P=s(52581);let D=e=>{window.open(e,"_blank")},k=async e=>{try{await navigator.clipboard.writeText(e),P.o.success("Invoice link copied to clipboard!")}catch(e){P.o.error("Failed to copy link")}},_=({isDownloading:e,onDownloadCSV:t,hasData:s})=>(0,r.jsxs)("div",{className:"mb-6 flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-3xl font-bold tracking-tight",children:"Billing"}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"Manage your subscription and billing information"})]}),(0,r.jsx)(o.$,{onClick:t,disabled:e||!s,className:"rounded-xl",children:e?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"animate-spin h-4 w-4 mr-2 border-2 border-white border-t-transparent rounded-full"}),"Exporting..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(u,{className:"h-4 w-4 mr-2"}),"Export Filtered Payments (CSV)"]})})]});var S=s(59821),I=s(85778),A=s(40228),F=s(5336),R=s(58199),q=s(48730),E=s(43649);let $=e=>{switch(e.toLowerCase()){case"paid":case"active":return(0,r.jsxs)(S.E,{variant:"default",className:"bg-green-100 text-green-800",children:[(0,r.jsx)(F.A,{className:"w-3 h-3 mr-1"}),"active"===e?"Active":"Paid"]});case"pending":return(0,r.jsxs)(S.E,{variant:"secondary",className:"bg-yellow-100 text-yellow-800",children:[(0,r.jsx)(q.A,{className:"w-3 h-3 mr-1"}),"Pending"]});case"failed":case"cancelled":return(0,r.jsxs)(S.E,{variant:"destructive",className:"bg-red-100 text-red-800",children:[(0,r.jsx)(E.A,{className:"w-3 h-3 mr-1"}),"cancelled"===e?"Cancelled":"Failed"]});default:return(0,r.jsx)(S.E,{variant:"outline",children:e})}},H=e=>{switch(e){case"free":return(0,r.jsx)(S.E,{variant:"secondary",children:"Free"});case"pro":return(0,r.jsx)(S.E,{variant:"default",children:"Pro"});case"enterprise":return(0,r.jsx)(S.E,{variant:"outline",children:"Enterprise"});default:return(0,r.jsx)(S.E,{variant:"outline",children:e})}},L=e=>e.find(e=>"active"===e.status||"pending"===e.status||"cancelled"!==e.status&&new Date(e.end_date)>new Date)||null,M=({billingData:e})=>{let t=()=>(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("h3",{className:"text-2xl font-bold",children:e?.currentPlan.name||"Free Plan"}),H(e?.currentPlan.type||"free")]}),(0,r.jsxs)("div",{className:"flex items-baseline gap-1",children:[(0,r.jsx)("span",{className:"text-3xl font-bold",children:(0,R.vv)(e?.currentPlan.price||0)}),(0,r.jsxs)("span",{className:"text-muted-foreground",children:["/",e?.currentPlan.billingCycle||"month"]})]}),e?.currentPlan.nextBillingDate&&(0,r.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[(0,r.jsx)(A.A,{className:"h-4 w-4"}),"Next billing date:"," ",(0,R.Yq)(e.currentPlan.nextBillingDate)]})]}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsx)("h4",{className:"font-medium",children:"Plan Features:"}),(0,r.jsx)("ul",{className:"space-y-2",children:(e?.currentPlan.features||[]).map((e,t)=>(0,r.jsxs)("li",{className:"flex items-center gap-2 text-sm",children:[(0,r.jsx)(F.A,{className:"h-4 w-4 text-green-500"}),e]},t))})]})]});return(0,r.jsxs)(c.Zp,{children:[(0,r.jsxs)(c.aR,{children:[(0,r.jsxs)(c.ZB,{className:"flex items-center gap-2",children:[(0,r.jsx)(I.A,{className:"h-5 w-5"}),"Current Plan"]}),(0,r.jsx)(c.BT,{children:"Your current subscription plan and usage"})]}),(0,r.jsx)(c.Wu,{children:(()=>{if(!e?.subscriptions||0===e.subscriptions.length)return t();let s=L(e.subscriptions);return s?(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("h3",{className:"text-2xl font-bold",children:s.plan.name}),$(s.status)]}),(0,r.jsxs)("div",{className:"flex items-baseline gap-1",children:[(0,r.jsx)("span",{className:"text-3xl font-bold",children:(0,R.vv)(s.price)}),(0,r.jsx)("span",{className:"text-muted-foreground",children:"/subscription"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[(0,r.jsx)(A.A,{className:"h-4 w-4"}),"Started: ",(0,R.Yq)(s.start_date)]}),(0,r.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[(0,r.jsx)(A.A,{className:"h-4 w-4"}),"Ends: ",(0,R.Yq)(s.end_date)]}),(0,r.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,r.jsx)("span",{className:"font-medium",children:"Service:"}),(0,r.jsx)(S.E,{variant:"outline",children:s.service})]})]})]}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsx)("h4",{className:"font-medium",children:"Plan Features:"}),s.plan.features&&s.plan.features.length>0?(0,r.jsx)("ul",{className:"space-y-2",children:s.plan.features.map((e,t)=>(0,r.jsxs)("li",{className:"flex items-center gap-2 text-sm",children:[(0,r.jsx)(F.A,{className:"h-4 w-4 text-green-500"}),e]},t))}):(0,r.jsx)("div",{className:"space-y-2",children:(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:s.plan.description||"No description available"})})]})]}):(0,r.jsxs)("div",{className:"text-center py-6",children:[(0,r.jsx)(I.A,{className:"h-12 w-12 mx-auto text-muted-foreground mb-3"}),(0,r.jsx)("p",{className:"text-muted-foreground mb-4",children:"No active subscription found"})]})})()})]})};var U=s(68988),T=s(39390),B=s(63974);let z=(0,d.A)("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),V=({showFilters:e,filters:t,onFilterChange:s,onResetFilters:a,statusOptions:n})=>e?(0,r.jsx)("div",{className:"mt-4 p-4 border rounded-xl bg-muted/20",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(T.J,{htmlFor:"start-date",children:"Start Date"}),(0,r.jsx)(U.p,{id:"start-date",type:"date",value:t.startDate,onChange:e=>s("startDate",e.target.value),className:"rounded-xl"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(T.J,{htmlFor:"end-date",children:"End Date"}),(0,r.jsx)(U.p,{id:"end-date",type:"date",value:t.endDate,onChange:e=>s("endDate",e.target.value),className:"rounded-xl"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(T.J,{htmlFor:"status-filter",children:"Status"}),(0,r.jsxs)(B.l6,{value:t.status,onValueChange:e=>s("status",e),children:[(0,r.jsx)(B.bq,{className:"rounded-xl",children:(0,r.jsx)(B.yv,{placeholder:"Select status"})}),(0,r.jsxs)(B.gC,{children:[(0,r.jsx)(B.eb,{value:"all",children:"All Statuses"}),n.map(e=>(0,r.jsx)(B.eb,{value:e.value,children:e.label},e.value))]})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(T.J,{children:"\xa0"}),(0,r.jsxs)(o.$,{variant:"outline",onClick:a,className:"w-full rounded-xl",children:[(0,r.jsx)(z,{className:"h-4 w-4 mr-2"}),"Reset"]})]})]})}):null;var O=s(25334);let J=(0,d.A)("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),Z=({invoices:e,onDownloadInvoice:t})=>(0,r.jsx)("div",{className:"space-y-4",children:e.map(e=>(0,r.jsxs)("div",{className:"flex items-center justify-between p-4 border rounded-xl",children:[(0,r.jsx)("div",{className:"flex items-center gap-4",children:(0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{className:"font-medium",children:[e.credit?.name||"Credits Top up"," - ",e.quantity," ","credits"]}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:(0,R.Yq)(e.created_at)})]})}),(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsx)("p",{className:"font-medium",children:(0,R.vv)(e.amount)}),$(e.status)]}),(0,r.jsx)("div",{className:"flex gap-2",children:e.payment_url&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.$,{variant:"ghost",size:"sm",onClick:()=>D(e.payment_url),className:"rounded-xl",title:"Open invoice link",children:(0,r.jsx)(O.A,{className:"h-4 w-4"})}),(0,r.jsx)(o.$,{variant:"ghost",size:"sm",onClick:()=>k(e.payment_url),className:"rounded-xl",title:"Copy invoice link",children:(0,r.jsx)(J,{className:"h-4 w-4"})})]})})]})]},e.id))});var Y=s(47033),G=s(14952);let W=({pagination:e,onPageChange:t,onItemsPerPageChange:s})=>e.totalPages<=1?null:(0,r.jsxs)("div",{className:"mt-6 flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(T.J,{htmlFor:"items-per-page",children:"Items per page:"}),(0,r.jsxs)(B.l6,{value:e.itemsPerPage.toString(),onValueChange:s,children:[(0,r.jsx)(B.bq,{className:"w-20 rounded-xl",children:(0,r.jsx)(B.yv,{})}),(0,r.jsxs)(B.gC,{children:[(0,r.jsx)(B.eb,{value:"5",children:"5"}),(0,r.jsx)(B.eb,{value:"10",children:"10"}),(0,r.jsx)(B.eb,{value:"20",children:"20"}),(0,r.jsx)(B.eb,{value:"50",children:"50"})]})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(o.$,{variant:"outline",size:"sm",onClick:()=>t(e.currentPage-1),disabled:1===e.currentPage,className:"rounded-xl",title:"Previous page",children:(0,r.jsx)(Y.A,{className:"h-4 w-4"})}),(0,r.jsxs)("span",{className:"text-sm text-muted-foreground",children:["Page ",e.currentPage," of ",e.totalPages]}),(0,r.jsx)(o.$,{variant:"outline",size:"sm",onClick:()=>t(e.currentPage+1),disabled:e.currentPage===e.totalPages,className:"rounded-xl",title:"Next page",children:(0,r.jsx)(G.A,{className:"h-4 w-4"})})]})]}),X=(0,d.A)("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]),K=({billingData:e,filteredInvoices:t,paginatedInvoices:s,pagination:a,filters:n,showFilters:i,onToggleFilters:l,onFilterChange:d,onResetFilters:u,onPageChange:m,onItemsPerPageChange:p,onDownloadInvoice:x,statusOptions:h})=>(0,r.jsxs)(c.Zp,{children:[(0,r.jsxs)(c.aR,{children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(c.ZB,{className:"flex items-center gap-2",children:"Credits Invoice History"}),(0,r.jsxs)(c.BT,{children:["View your credits invoices (",t.length," of"," ",e?.creditsInvoices.length||0," total)"]})]}),(0,r.jsxs)(o.$,{variant:"outline",size:"sm",onClick:l,className:"rounded-xl",children:[(0,r.jsx)(X,{className:"h-4 w-4 mr-2"}),i?"Hide":"Show"," Filters"]})]}),(0,r.jsx)(V,{showFilters:i,filters:n,onFilterChange:d,onResetFilters:u,statusOptions:h})]}),(0,r.jsx)(c.Wu,{children:s.length?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(Z,{invoices:s,onDownloadInvoice:x}),(0,r.jsx)(W,{pagination:a,onPageChange:m,onItemsPerPageChange:p})]}):(0,r.jsxs)("div",{className:"text-center py-6",children:[(0,r.jsx)("p",{className:"text-muted-foreground mb-4",children:e?.creditsInvoices.length?"No invoices match your current filters":"No credits invoices available"}),e?.creditsInvoices.length&&(0,r.jsxs)(o.$,{variant:"outline",onClick:u,className:"rounded-xl",children:[(0,r.jsx)(z,{className:"h-4 w-4 mr-2"}),"Clear Filters"]})]})})]}),Q=(e,t)=>e.filter(e=>{let s=new Date(e.created_at),r=t.startDate?new Date(t.startDate):null,a=t.endDate?new Date(t.endDate):null;return(!r||!(s<r))&&(!a||!(s>a))&&(!t.status||"all"===t.status||e.status.toLowerCase()===t.status.toLowerCase())}),ee=(e,t,s)=>{let r=(t-1)*s;return e.slice(r,r+s)},et=({isDownloading:e,onDownloadXML:t,hasData:s})=>(0,r.jsxs)("div",{className:"mb-6 flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-3xl font-bold tracking-tight",children:"Billing"}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"Manage your subscription and billing information"})]}),(0,r.jsx)(o.$,{onClick:t,disabled:e||!s,className:"rounded-xl",children:e?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"animate-spin h-4 w-4 mr-2 border-2 border-white border-t-transparent rounded-full"}),"Exporting..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(u,{className:"h-4 w-4 mr-2"}),"Export Filtered Payments (CSV)"]})})]});function es(){let{user:e}=(0,n.A)();(0,i.useRouter)();let[t,s]=(0,a.useState)(null),[o,d]=(0,a.useState)(!0),[u,m]=(0,a.useState)(!1),[p,x]=(0,a.useState)({currentPage:1,itemsPerPage:5,totalItems:0,totalPages:0}),[h,g]=(0,a.useState)({startDate:"",endDate:"",status:"all"}),[f,v]=(0,a.useState)(!1),{filteredInvoices:j,paginatedInvoices:y}=(0,a.useMemo)(()=>{if(!t?.creditsInvoices)return{filteredInvoices:[],paginatedInvoices:[]};let e=Q(t.creditsInvoices,h),s=Math.ceil(e.length/p.itemsPerPage);x(t=>({...t,totalItems:e.length,totalPages:s,currentPage:t.currentPage>s?1:t.currentPage}));let r=ee(e,p.currentPage,p.itemsPerPage);return{filteredInvoices:e,paginatedInvoices:r}},[t?.creditsInvoices,h,p.currentPage,p.itemsPerPage]),b=async()=>{if(t){m(!0);try{await C(t,j,"combined")}catch(e){console.error("Failed to download CSV:",e)}finally{m(!1)}}};return e?o?(0,r.jsx)(l.A,{children:(0,r.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("h2",{className:"text-3xl font-bold tracking-tight",children:"Billing"}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"Loading billing information..."})]}),(0,r.jsx)("div",{className:"grid gap-6",children:[1,2,3].map(e=>(0,r.jsx)(c.Zp,{children:(0,r.jsx)(c.Wu,{className:"p-6",children:(0,r.jsxs)("div",{className:"animate-pulse space-y-4",children:[(0,r.jsx)("div",{className:"h-4 bg-muted rounded w-1/4"}),(0,r.jsx)("div",{className:"h-8 bg-muted rounded w-1/2"}),(0,r.jsx)("div",{className:"h-4 bg-muted rounded w-3/4"})]})})},e))})]})}):(0,r.jsx)(l.A,{children:(0,r.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,r.jsx)(et,{isDownloading:u,onDownloadXML:b,hasData:!!t}),(0,r.jsx)("div",{className:"grid gap-6",children:(0,r.jsx)(K,{billingData:t,filteredInvoices:j,paginatedInvoices:y,pagination:p,filters:h,showFilters:f,onToggleFilters:()=>v(!f),onFilterChange:(e,t)=>{g(s=>({...s,[e]:t})),x(e=>({...e,currentPage:1}))},onResetFilters:()=>{g({startDate:"",endDate:"",status:"all"}),x(e=>({...e,currentPage:1}))},onPageChange:e=>{x(t=>({...t,currentPage:e}))},onItemsPerPageChange:e=>{x(t=>({...t,itemsPerPage:parseInt(e),currentPage:1}))},onDownloadInvoice:e=>{console.log("Download invoice:",e)},statusOptions:t?.creditsInvoices?[...new Set(t.creditsInvoices.map(e=>e.status))].map(e=>({value:e.toLowerCase(),label:e})):[]})})]})}):null}},33873:e=>{"use strict";e.exports=require("path")},34912:(e,t,s)=>{Promise.resolve().then(s.bind(s,33642))},40228:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(62688).A)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},43649:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(62688).A)("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},47033:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(62688).A)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},48064:(e,t,s)=>{Promise.resolve().then(s.bind(s,6264))},48730:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(62688).A)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},55192:(e,t,s)=>{"use strict";s.d(t,{BT:()=>c,Wu:()=>d,ZB:()=>o,Zp:()=>i,aR:()=>l,wL:()=>u});var r=s(60687),a=s(43210),n=s(96241);let i=a.forwardRef(({className:e,...t},s)=>(0,r.jsx)("div",{ref:s,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));i.displayName="Card";let l=a.forwardRef(({className:e,...t},s)=>(0,r.jsx)("div",{ref:s,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",e),...t}));l.displayName="CardHeader";let o=a.forwardRef(({className:e,...t},s)=>(0,r.jsx)("div",{ref:s,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",e),...t}));o.displayName="CardTitle";let c=a.forwardRef(({className:e,...t},s)=>(0,r.jsx)("div",{ref:s,className:(0,n.cn)("text-sm text-muted-foreground",e),...t}));c.displayName="CardDescription";let d=a.forwardRef(({className:e,...t},s)=>(0,r.jsx)("div",{ref:s,className:(0,n.cn)("p-6 pt-0",e),...t}));d.displayName="CardContent";let u=a.forwardRef(({className:e,...t},s)=>(0,r.jsx)("div",{ref:s,className:(0,n.cn)("flex items-center p-6 pt-0",e),...t}));u.displayName="CardFooter"},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},58199:(e,t,s)=>{"use strict";s.d(t,{Yq:()=>r,ak:()=>n,eF:()=>l,kR:()=>i,vv:()=>a});let r=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),a=e=>new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP",minimumFractionDigits:0,maximumFractionDigits:0}).format(e),n=e=>{if(!e)return"N/A";let t=new Date(e),s=new Date().getTime()-t.getTime(),r=Math.floor(s/864e5),a=Math.floor(s/36e5),n=Math.floor(s/6e4);return r>0?`${r} day${r>1?"s":""} ago`:a>0?`${a} hour${a>1?"s":""} ago`:n>0?`${n} minute${n>1?"s":""} ago`:"Just now"},i=e=>{if(!e)return!1;let t=new Date(e);return new Date().getTime()-t.getTime()<=2592e5},l=e=>{if(!e)return 0;let t=new Date(e),s=new Date;t.setHours(0,0,0,0);let r=new Date(s);return r.setHours(0,0,0,0),Math.max(0,3-Math.floor((r.getTime()-t.getTime())/864e5))}},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},63974:(e,t,s)=>{"use strict";s.d(t,{bq:()=>m,eb:()=>g,gC:()=>h,l6:()=>d,mi:()=>f,yv:()=>u});var r=s(60687),a=s(43210),n=s(25911),i=s(78272),l=s(3589),o=s(13964),c=s(96241);let d=n.bL;n.YJ;let u=n.WT,m=a.forwardRef(({className:e,children:t,...s},a)=>(0,r.jsxs)(n.l9,{ref:a,className:(0,c.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...s,children:[t,(0,r.jsx)(n.In,{asChild:!0,children:(0,r.jsx)(i.A,{className:"h-4 w-4 opacity-50"})})]}));m.displayName=n.l9.displayName;let p=a.forwardRef(({className:e,...t},s)=>(0,r.jsx)(n.PP,{ref:s,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",e),...t,children:(0,r.jsx)(l.A,{className:"h-4 w-4"})}));p.displayName=n.PP.displayName;let x=a.forwardRef(({className:e,...t},s)=>(0,r.jsx)(n.wn,{ref:s,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",e),...t,children:(0,r.jsx)(i.A,{className:"h-4 w-4"})}));x.displayName=n.wn.displayName;let h=a.forwardRef(({className:e,children:t,position:s="popper",...a},i)=>(0,r.jsx)(n.ZL,{children:(0,r.jsxs)(n.UC,{ref:i,className:(0,c.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===s&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:s,...a,children:[(0,r.jsx)(p,{}),(0,r.jsx)(n.LM,{className:(0,c.cn)("p-1","popper"===s&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),(0,r.jsx)(x,{})]})}));h.displayName=n.UC.displayName,a.forwardRef(({className:e,...t},s)=>(0,r.jsx)(n.JU,{ref:s,className:(0,c.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...t})).displayName=n.JU.displayName;let g=a.forwardRef(({className:e,children:t,...s},a)=>(0,r.jsxs)(n.q7,{ref:a,className:(0,c.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...s,children:[(0,r.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.jsx)(n.VF,{children:(0,r.jsx)(o.A,{className:"h-4 w-4"})})}),(0,r.jsx)(n.p4,{children:t})]}));g.displayName=n.q7.displayName;let f=a.forwardRef(({className:e,...t},s)=>(0,r.jsx)(n.wv,{ref:s,className:(0,c.cn)("-mx-1 my-1 h-px bg-muted",e),...t}));f.displayName=n.wv.displayName},74075:e=>{"use strict";e.exports=require("zlib")},79551:e=>{"use strict";e.exports=require("url")},81630:e=>{"use strict";e.exports=require("http")},94735:e=>{"use strict";e.exports=require("events")},97834:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>i.a,__next_app__:()=>u,pages:()=>d,routeModule:()=>m,tree:()=>c});var r=s(65239),a=s(48088),n=s(88170),i=s.n(n),l=s(30893),o={};for(let e in l)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);s.d(t,o);let c={children:["",{children:["(main)",{children:["billing",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,6264)),"C:\\Users\\lagtn\\Documents\\luxeproof\\app\\(main)\\billing\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,19559)),"C:\\Users\\lagtn\\Documents\\luxeproof\\app\\(main)\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(s.t.bind(s,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(s.t.bind(s,65284,23)),"next/dist/client/components/unauthorized-error"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,58014)),"C:\\Users\\lagtn\\Documents\\luxeproof\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(s.t.bind(s,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(s.t.bind(s,65284,23)),"next/dist/client/components/unauthorized-error"]}]}.children,d=["C:\\Users\\lagtn\\Documents\\luxeproof\\app\\(main)\\billing\\page.tsx"],u={require:s,loadChunk:()=>Promise.resolve()},m=new r.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/(main)/billing/page",pathname:"/billing",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[754,160,969,474,234,911,534,513],()=>s(97834));module.exports=r})();