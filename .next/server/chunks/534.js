exports.id=534,exports.ids=[534],exports.modules={13737:(e,t,o)=>{"use strict";o.d(t,{AuthProvider:()=>s});var r=o(12907);let s=(0,r.registerClientReference)(function(){throw Error("Attempted to call AuthProvider() from the server but AuthProvider is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\lagtn\\Documents\\luxeproof\\components\\auth-provider.tsx","AuthProvider");(0,r.registerClientReference)(function(){throw Error("Attempted to call useAuth() from the server but useAuth is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\lagtn\\Documents\\luxeproof\\components\\auth-provider.tsx","useAuth")},15527:(e,t,o)=>{"use strict";o.d(t,{A:()=>d,AuthProvider:()=>u});var r=o(60687),s=o(43210),a=o(16189),n=o(51060),i=o(52581);let l={ACCESS_TOKEN:"accessToken",REFRESH_TOKEN:"refreshToken",USER:"user",LOGGED_IN:"loggedIn",JUST_LOGGED_IN:"justLoggedIn",AUTH_TOKEN:"auth_token",PKCE_VERIFIER:"pkce_code_verifier"},c={LOGIN:"/login",DASHBOARD:"/dashboard"},h=(0,s.createContext)(null);function u({children:e}){let[t,o]=(0,s.useState)(null),[u,d]=(0,s.useState)(!0),p=(0,a.useRouter)(),m="https://stg.luxevipsuite.com",g=(0,s.useCallback)(()=>{Object.values(l).forEach(e=>{localStorage.removeItem(e),sessionStorage.removeItem(e)})},[]),f=(0,s.useCallback)(e=>{sessionStorage.setItem(l.USER,JSON.stringify(e)),sessionStorage.setItem(l.LOGGED_IN,"true"),o(e)},[]);(0,s.useCallback)(()=>{try{let e=sessionStorage.getItem(l.USER);if(!e)return null;let t=JSON.parse(e);return t.data||t}catch(e){return console.error("Failed to parse stored user:",e),sessionStorage.removeItem(l.USER),null}},[]);let S=(0,s.useCallback)(async e=>{let t=localStorage.getItem(l.PKCE_VERIFIER);if(!t)throw Error("PKCE code verifier missing. Please start the login process again.");let o=new URLSearchParams({grant_type:"authorization_code",client_id:"01998003-aa09-70b2-a106-1fd34098f380",redirect_uri:"https://stgapp.luxeproof.com/auth/callback",code:e,code_verifier:t});try{let e=await fetch(`${m}/oauth/token`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"},body:o.toString()}),t=await e.json();if(!e.ok)throw console.error("OAuth token error response:",t),Error(t.error_description||"Failed to exchange authorization code");return localStorage.removeItem(l.PKCE_VERIFIER),t}catch(e){throw console.error("Token exchange failed:",e),e}},[m]),v=(0,s.useCallback)(async()=>{try{let e=await fetch(`${m}/api/refresh-token`,{method:"POST",credentials:"include",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!e.ok)throw Error("Failed to refresh token");return(await e.json()).access_token}catch(e){throw console.error("Token refresh failed:",e),window.location.href=c.LOGIN,e}},[m]),E=(0,s.useCallback)(async(e=!1)=>{let t=localStorage.getItem(l.ACCESS_TOKEN);if(!t)throw Error("No access token available");try{let o=await fetch(`${m}/api/user`,{method:"GET",headers:{Authorization:`Bearer ${t}`,Accept:"application/json","Content-Type":"application/json"}});if(!o.ok){if(401===o.status){let t=await v();return localStorage.setItem(l.ACCESS_TOKEN,t),E(e)}throw Error("Failed to fetch user data")}let r=await o.json(),s=r.data||r;return f(s),sessionStorage.getItem(l.JUST_LOGGED_IN)&&(i.o.success("Logged in successfully!"),sessionStorage.removeItem(l.JUST_LOGGED_IN)),e&&p.push(c.DASHBOARD),s}catch(e){throw console.error("Error fetching user data:",e),e}},[m,v,p,f]),b=(0,s.useCallback)(async e=>{let t=localStorage.getItem(l.ACCESS_TOKEN);if(!t)throw Error("No auth token found");console.log(e);let o={name:e.name,email:e.email,phone_number:e.phone_number,timezone:e.timezone,account:{name:e.businessName,slug:e.businessSlug}};try{let e=await n.A.put(`${m}/api/user`,o,{headers:{Authorization:`Bearer ${t}`,Accept:"application/json","Content-Type":"application/json"}}),r=e.data.data||e.data;return f(r),i.o.success("Watch data submitted successfully"),r}catch(e){throw i.o.error("Profile Update Failed!"),e}},[m,f]),C=(0,s.useCallback)(()=>{let e=localStorage.getItem(l.ACCESS_TOKEN),t=sessionStorage.getItem(l.USER);return!!(e&&t)},[]),w=(0,s.useCallback)(async(e,t={})=>{let o=localStorage.getItem(l.ACCESS_TOKEN);if(!o)throw Error("No access token available");let r=async o=>fetch(e,{...t,headers:{...t.headers,Authorization:`Bearer ${o}`,Accept:"application/json","Content-Type":"application/json"}}),s=await r(o);if(401===s.status)try{let e=await v();return localStorage.setItem(l.ACCESS_TOKEN,e),r(e)}catch(e){throw await A(),e}return s},[v]),P=(0,s.useCallback)(async(e,t,o)=>{console.log(e);let r=localStorage.getItem(l.ACCESS_TOKEN);try{let s=await w(`${m}/api/user/change-password`,{headers:{Authorization:`Bearer ${r}`,Accept:"application/json","Content-Type":"application/json"},method:"PUT",credentials:"include",body:JSON.stringify({currentPassword:e,newPassword:t,newPassword_confirmation:o})});if(!s.ok){let e=await s.json();throw Error(e.message||"Failed to change password")}i.o.success("Password changed successfully!")}catch(e){throw i.o.error(e.message||"Password change failed"),e}},[w,m]),A=(0,s.useCallback)(async()=>{try{let e=localStorage.getItem(l.ACCESS_TOKEN);e&&await fetch(`${m}/api/logout`,{method:"POST",credentials:"include",headers:{Accept:"application/json",Authorization:`Bearer ${e}`}})}catch(e){console.error("Logout API call failed:",e)}finally{g(),o(null),window.location.href=c.LOGIN}},[m,g]);return u?(0,r.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:"Loading..."}):(0,r.jsx)(h.Provider,{value:{user:t,isLoading:u,logout:A,updateUser:b,changePassword:P,exchangeAuthorizationCode:S,refreshAccessToken:v,fetchUserData:E,isAuthenticated:C,authenticatedRequest:w},children:e})}let d=()=>{let e=(0,s.useContext)(h);if(!e)throw Error("useAuth must be used within an AuthProvider");return e}},54647:()=>{},58014:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>c,metadata:()=>l});var r=o(37413),s=o(61421),a=o.n(s);o(82704);var n=o(13737),i=o(6931);let l={title:"Luxe Proof",description:"Professional watch authentication and verification platform",icons:{icon:"./icon.svg",shortcut:"./icon.svg",apple:"./icon.svg"}};function c({children:e}){return(0,r.jsx)("html",{lang:"en",children:(0,r.jsxs)("body",{className:a().className,children:[(0,r.jsx)(i.Toaster,{position:"top-right",richColors:!0,closeButton:!0}),(0,r.jsx)(n.AuthProvider,{children:e})]})})}},60271:(e,t,o)=>{Promise.resolve().then(o.t.bind(o,16444,23)),Promise.resolve().then(o.t.bind(o,16042,23)),Promise.resolve().then(o.t.bind(o,88170,23)),Promise.resolve().then(o.t.bind(o,49477,23)),Promise.resolve().then(o.t.bind(o,29345,23)),Promise.resolve().then(o.t.bind(o,12089,23)),Promise.resolve().then(o.t.bind(o,46577,23)),Promise.resolve().then(o.t.bind(o,31307,23))},66276:(e,t,o)=>{Promise.resolve().then(o.bind(o,13737)),Promise.resolve().then(o.bind(o,6931))},68519:(e,t,o)=>{Promise.resolve().then(o.t.bind(o,86346,23)),Promise.resolve().then(o.t.bind(o,27924,23)),Promise.resolve().then(o.t.bind(o,35656,23)),Promise.resolve().then(o.t.bind(o,40099,23)),Promise.resolve().then(o.t.bind(o,38243,23)),Promise.resolve().then(o.t.bind(o,28827,23)),Promise.resolve().then(o.t.bind(o,62763,23)),Promise.resolve().then(o.t.bind(o,97173,23))},82704:()=>{},96132:(e,t,o)=>{Promise.resolve().then(o.bind(o,15527)),Promise.resolve().then(o.bind(o,52581))}};